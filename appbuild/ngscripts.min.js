var app=angular.module("PlacesApp",["ngRoute","ngResource","ui.bootstrap"]);app.config(function(e){e.when("/explore",{templateUrl:"app/views/places.html",controller:"placesController"}).when("/about",{templateUrl:"app/views/about.html"}).otherwise({redirectTo:"/explore"})}),app.controller("placesController",function(e,t,r){function o(){l(),n()}function n(){var r=e.pageSize*(e.currentPage-1);t.get({near:e.exploreNearby,query:e.exploreQuery,limit:e.pageSize,offset:r},function(t){t.response.groups?(e.places=t.response.groups[0].items,e.totalRecordsCount=t.response.totalResults,a("")):(e.places=[],e.totalRecordsCount=0)})}function a(t){e.filteredPlaces=r("placeFilter")(e.places,t),e.filteredPlacesCount=e.filteredPlaces.length}function l(){e.$watch("filterValue",function(e){a(e)})}e.exploreNearby="London",e.exploreQuery="",e.filterValue="",e.places=[],e.filteredPlaces=[],e.filteredPlacesCount=0,e.totalRecordsCount=0,e.pageSize=30,e.currentPage=1,o(),e.doSearch=function(){n()},e.buildCategoryIcon=function(e){return e.prefix+"44"+e.suffix},e.buildVenueThumbnail=function(e){return e.items[0].prefix+"128x128"+e.items[0].suffix}}),app.filter("placeFilter",function(){return function(e,t){if(!t)return e;var r=[];t=t.toLowerCase();for(var o=0;o<e.length;o++){var n=e[o];(n.venue.name.toLowerCase().indexOf(t)>-1||n.venue.categories[0].shortName.toLowerCase().indexOf(t)>-1)&&r.push(n)}return r}});var requestParms={clientId:"LSYLG2JMCTP1GIZUOK1BPGH3MXSU53SARHCPWTCWVAT1SU1T",clientSecret:"3AARGT0JQCW5SFFA2HDWWD04PTONWP2X4OCSTKH4HEY2V2HF",version:"20131230"};app.factory("placesService",function(e){var t="https://api.foursquare.com/v2/venues/:action",r=e(t,{action:"explore",client_id:requestParms.clientId,client_secret:requestParms.clientSecret,v:requestParms.version,venuePhotos:"1",callback:"JSON_CALLBACK"},{get:{method:"JSONP"}});return r});